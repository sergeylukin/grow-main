{"ast":null,"code":"import _objectSpread from\"/Users/sergey/code/grow/pres2/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _objectWithoutProperties from\"/Users/sergey/code/grow/pres2/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";var _excluded=[\"children\",\"size\",\"left\",\"right\",\"top\",\"bottom\",\"color\",\"opacity\",\"height\",\"layers\",\"font\"],_excluded2=[\"text\",\"size\",\"lineHeight\",\"position\"];import{FontLoader,Vector3,TextBufferGeometry}from\"three\";import React,{useCallback,useRef}from\"react\";import{useLoader,useFrame}from\"@react-three/fiber\";import{useAsset}from\"use-asset\";import lerp from\"lerp\";import state from\"../store\";import{jsx as _jsx}from\"react/jsx-runtime\";function Text(_ref){var children=_ref.children,_ref$size=_ref.size,size=_ref$size===void 0?1:_ref$size,left=_ref.left,right=_ref.right,top=_ref.top,bottom=_ref.bottom,_ref$color=_ref.color,color=_ref$color===void 0?\"white\":_ref$color,_ref$opacity=_ref.opacity,opacity=_ref$opacity===void 0?1:_ref$opacity,_ref$height=_ref.height,height=_ref$height===void 0?0.01:_ref$height,_ref$layers=_ref.layers,layers=_ref$layers===void 0?0:_ref$layers,_ref$font=_ref.font,font=_ref$font===void 0?\"/MOONGET_Heavy.blob\":_ref$font,props=_objectWithoutProperties(_ref,_excluded);var data=useLoader(FontLoader,font);var geom=useAsset(function(){return new Promise(function(res){return res(new TextBufferGeometry(children,{font:data,size:1,height:height,curveSegments:32}));});},[children]);var onUpdate=useCallback(function(self){var box=new Vector3();self.geometry.computeBoundingBox();self.geometry.boundingBox.getSize(box);self.position.x=left?0:right?-box.x:-box.x/2;self.position.y=top?0:bottom?-box.y:-box.y/2;},[left,right,top,bottom]);var ref=useRef();var last=state.top.current;useFrame(function(){ref.current.shift=lerp(ref.current.shift,(state.top.current-last)/100,0.1);last=state.top.current;});return/*#__PURE__*/_jsx(\"group\",_objectSpread(_objectSpread({},props),{},{scale:[size,size,0.1],children:/*#__PURE__*/_jsx(\"mesh\",{geometry:geom,onUpdate:onUpdate,frustumCulled:false,children:/*#__PURE__*/_jsx(\"customMaterial\",{ref:ref,color:color,transparent:true,opacity:opacity})})}));}var MultilineText=function MultilineText(_ref2){var text=_ref2.text,_ref2$size=_ref2.size,size=_ref2$size===void 0?1:_ref2$size,_ref2$lineHeight=_ref2.lineHeight,lineHeight=_ref2$lineHeight===void 0?1:_ref2$lineHeight,_ref2$position=_ref2.position,position=_ref2$position===void 0?[0,0,0]:_ref2$position,props=_objectWithoutProperties(_ref2,_excluded2);return text.split(\"\\n\").map(function(text,index){return/*#__PURE__*/_jsx(Text,_objectSpread(_objectSpread({size:size},props),{},{position:[position[0],position[1]-index*lineHeight,position[2]],children:text}),index);});};export{Text,MultilineText};","map":{"version":3,"sources":["/Users/sergey/code/grow/pres2/src/components/Text.js"],"names":["FontLoader","Vector3","TextBufferGeometry","React","useCallback","useRef","useLoader","useFrame","useAsset","lerp","state","Text","children","size","left","right","top","bottom","color","opacity","height","layers","font","props","data","geom","Promise","res","curveSegments","onUpdate","self","box","geometry","computeBoundingBox","boundingBox","getSize","position","x","y","ref","last","current","shift","MultilineText","text","lineHeight","split","map","index"],"mappings":"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","sourcesContent":["import { FontLoader, Vector3, TextBufferGeometry } from \"three\"\nimport React, { useCallback, useRef } from \"react\"\nimport { useLoader, useFrame } from \"@react-three/fiber\"\nimport { useAsset } from \"use-asset\"\nimport lerp from \"lerp\"\nimport state from \"../store\"\n\nfunction Text({ children, size = 1, left, right, top, bottom, color = \"white\", opacity = 1, height = 0.01, layers = 0, font = \"/MOONGET_Heavy.blob\", ...props }) {\n  const data = useLoader(FontLoader, font)\n  const geom = useAsset(() => new Promise((res) => res(new TextBufferGeometry(children, { font: data, size: 1, height, curveSegments: 32 }))), [children])\n  const onUpdate = useCallback(\n    (self) => {\n      const box = new Vector3()\n      self.geometry.computeBoundingBox()\n      self.geometry.boundingBox.getSize(box)\n      self.position.x = left ? 0 : right ? -box.x : -box.x / 2\n      self.position.y = top ? 0 : bottom ? -box.y : -box.y / 2\n    },\n    [left, right, top, bottom]\n  )\n\n  const ref = useRef()\n  let last = state.top.current\n  useFrame(() => {\n    ref.current.shift = lerp(ref.current.shift, (state.top.current - last) / 100, 0.1)\n    last = state.top.current\n  })\n\n  return (\n    <group {...props} scale={[size, size, 0.1]}>\n      <mesh geometry={geom} onUpdate={onUpdate} frustumCulled={false}>\n        <customMaterial ref={ref} color={color} transparent opacity={opacity} />\n      </mesh>\n    </group>\n  )\n}\n\nconst MultilineText = ({ text, size = 1, lineHeight = 1, position = [0, 0, 0], ...props }) =>\n  text.split(\"\\n\").map((text, index) => <Text key={index} size={size} {...props} position={[position[0], position[1] - index * lineHeight, position[2]]} children={text} />)\n\nexport { Text, MultilineText }\n"]},"metadata":{},"sourceType":"module"}